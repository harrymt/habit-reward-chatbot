#!/usr/bin/env node

'use strict';

console.log('Sending reminders..');

// Send to logging service
const request = require('request-promise');

const options = {
  method: 'GET',
  uri: 'https://nosnch.in/9e699ea11f'
};
request(options)
  .then(response => {
    console.log(response);
    start();
  })
  .catch(err => {
    console.log(err);
    start();
  });

function start() {

  // Check if debug args are passed into function
  process.argv.forEach((val, index) => {
    if (index === 2) {
      // Actually send the reminders here
      require('../reminders').sendReminders(val, success => {
        console.log(success);
        process.exit();
      });
    }
  });

  // Actually send the reminders here
  require('../reminders').sendReminders(null, success => {
    process.exit();
  });

}
